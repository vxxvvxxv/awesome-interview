
Поток — это наименьшая единица выполнения внутри процесса. Каждый процесс может иметь несколько потоков, которые выполняются параллельно. Потоки разделяют память и ресурсы процесса (например, файловые дескрипторы), но имеют собственные:

- Стек вызовов.    
- Регистры процессора.
- Состояние выполнения (например, счетчик команд).

## Как работает?

1. **Создание потока**:
	1. ОС выделяет память под стек потока (обычно 1–8 МБ) и настраивает контекст выполнения.
2. **Планирование**:
	1. Планировщик ОС распределяет время CPU между потоками, переключая контекст (сохранение/восстановление регистров и стека).
3. **Синхронизация**:
	1. Потоки используют мьютексы, семафоры и другие примитивы для работы с общими ресурсами.
    

## Почему потоки «дорогие»?

- **Память**: 
	- Каждый поток требует выделения большого стека (даже если не используется полностью).
- **Создание/удаление**: 
	- Системные вызовы (`pthread_create` в Linux) занимают время.
- **Переключение контекста**: 
	- Сохранение и восстановление состояния потока требует ~1–10 мкс (зависит от ОС и железа).
- **Ограничения**: 
	- ОС не позволяет создавать миллионы потоков (например, лимит `ulimit -u` в Linux).


